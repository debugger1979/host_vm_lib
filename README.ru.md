[![en](https://img.shields.io/badge/lang-en-blue.svg)](https://github.com/debugger1979/host_vm_lib/tree/main/README.md)

# Библиотека для работы с API HOSTVM VDI (OpenUDS)
## Предназначена для автоматизации процесса конфигурирования параметров платформы виртуализации HOSTVM

С помощью данной библиотеки можно выполнить следующие операции:
- Работа с конфигурацией самого приложения HOSTVM VDI (изменение параметров)
- Администрирвание учетных записей (смена пароля суперпользователя)
- Работа с аутентификаторами (создание, чтение, изменение, удаление)
- Работа с группами доступа, внутри аутентификатора (создание, чтение, изменение, удаление)
- Работа с сервис-провайдерами, сервисами (создание, чтение, изменение, удаление)
- Работа с транспортами (создание, чтение, изменение, удаление)
- Работа с менеджерами ОС (создание, чтение, изменение, удаление)
- Работа с пулами сервисов (создание, чтение, изменение, удаление, привязка групп доступа, транспортов, менеджеров ОС, провайдеров)

## Примеры работы с библиотекой:

_Примечание:_
 1. _Для создания объектов (аутентификаторы, группы, сервис-провайдеры и т.д.) необходимы определенные параметры, оформленные в формате словаря. Рекомендация - изначально создать "руками" эти в объекты в самом приложении, а потом прочитать с помощью методов данной библиотеки. Далее полученные структуры использовать в своих скриптах. Позднее будут выложены шаблоны параметров._
 2. _В библиотеке реализована возможность обращения к объектам по их наименованию (как указано в самом приложении), а не по id_
 3. _**Важно!** Для изменения параметров в приложении необходима учетная запись суперпользователя._

- Авторизация в приложении. Данная операция необходима только один раз на весь сеанс работы с приложением.  

```
from host_vm_lib import HostVMAPI

# Базовый адрес для доступа к методам приложения
rest_url = 'http://URL-HOSTVM/rest/'
# Строка для авторизации в приложении
parameters = '{"auth": "admin", "username": "user", "password": "password"}'

hostvm = HostVMAPI()

if hostvm.login(rest_url=rest_url, parameters=parameters) == 0:
    # Авторизация в приложении прошла успешно
    # ... (выполнение необходимых манипуляций с приложениеме)
else:
    # Возникли проблемы при авторизации. Сообщение об ошибке можно получить в свойстве класса - status_msg
    print(hostvm.status_msg)
```

- Создание сервис-провайдера. Используется словарь, содержащий параметры создаваемого сервис-провайдера 

```
    data = {
        "id": "",
        "name": "cloud.ru",
        "tags": [],
        "comments": "",
        "type": "openNebulaPlatform",
        "host": "имя хоста сервера виртуализации",
        "port": "2633",
        "ssl": False,
        "username": "user",
        "password": "password",
        "maxPreparingServices": "10",
        "maxRemovingServices": "5",
        "timeout": "10"
        }
    hostvm.create_provider(data)
    print(hostvm.status_msg)
```
